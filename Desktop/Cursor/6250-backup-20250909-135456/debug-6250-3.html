<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug 6250-3</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .error { background: #ffcccc; }
        .success { background: #ccffcc; }
    </style>
</head>
<body>
    <h1>Debug 6250-3</h1>
    <div id="debug"></div>
    
    <div id="thicknessCarousel">
        <div class="carousel-item selected" data-value="thin">
            <img src="6250-3/images/thin.png" alt="Тонкий">
        </div>
        <div class="carousel-item" data-value="thick">
            <img src="6250-3/images/bold.png" alt="Стандартный">
        </div>
    </div>
    
    <div id="stickerPreview" style="width: 200px; height: 200px; border: 1px solid #ccc; position: relative;"></div>

    <script>
        function debug(message, isError = false) {
            const div = document.createElement('div');
            div.className = `debug ${isError ? 'error' : 'success'}`;
            div.textContent = message;
            document.getElementById('debug').appendChild(div);
        }

        // Копируем код из 6250-3/designer-advanced.html
        let currentSelections = {
            thickness: 'thin'
        };
        
        function updateStickerPreview() {
            debug('updateStickerPreview called');
            const preview = document.getElementById('stickerPreview');
            if (!preview) {
                debug('stickerPreview not found', true);
                return;
            }
            
            let stickerNumber, stickerName, shape;
            if (currentSelections.thickness === 'thin') {
                stickerNumber = 15;
                stickerName = 'sticker-15-stick.png';
                shape = 'cutout';
            } else {
                stickerNumber = 11;
                stickerName = 'sticker-11-stick.png';
                shape = 'small-rectangle';
            }
            
            const imageSrc = `6250-3/images/${stickerName}`;
            preview.innerHTML = `<img src="${imageSrc}" alt="Стикер ${stickerNumber}" style="width: 100%; height: 100%; object-fit: contain;">`;
            positionSticker(preview, shape);
            debug(`Sticker updated: ${stickerName}, shape: ${shape}`);
        }

        function positionSticker(preview, shape) {
            debug(`positionSticker called with shape: ${shape}`);
            const positions = {
                'rectangle': { top: '75%', left: '50%', transform: 'translate(-50%, -50%)', width: '280px', height: '80px' },
                'square': { top: '75%', left: '50%', transform: 'translate(-50%, -50%)', width: '100px', height: '100px' },
                'circle': { top: '75%', left: '50%', transform: 'translate(-50%, -50%)', width: '100px', height: '100px' },
                'small-rectangle': { top: '15%', left: '75%', transform: 'translate(-50%, -50%)', width: '300px', height: '80px' },
                'cutout': { top: '80%', left: '50%', transform: 'translate(-50%, -50%)', width: '350px', height: '110px' }
            };
            
            const position = positions[shape] || positions['rectangle'];
            Object.assign(preview.style, position);
            debug(`Position applied: ${JSON.stringify(position)}`);
        }

        function initCarousels() {
            debug('initCarousels called');
            const thicknessCarousel = document.getElementById('thicknessCarousel');
            
            if (thicknessCarousel) {
                debug('thicknessCarousel found');
                thicknessCarousel.addEventListener('click', (e) => {
                    debug('Carousel clicked');
                    const item = e.target.closest('.carousel-item');
                    if (item) {
                        debug(`Item clicked: ${item.dataset.value}`);
                        // Remove selection from siblings
                        const siblings = thicknessCarousel.querySelectorAll('.carousel-item');
                        siblings.forEach(sibling => sibling.classList.remove('selected'));
                        
                        // Add selection to clicked item
                        item.classList.add('selected');
                        
                        // Update current selection
                        const value = item.dataset.value;
                        currentSelections.thickness = value;
                        
                        debug(`Thickness selected: ${value}`);
                        
                        // Update sticker preview
                        updateStickerPreview();
                    }
                });
            } else {
                debug('thicknessCarousel not found', true);
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            debug('DOM loaded');
            initCarousels();
            updateStickerPreview();
        });
    </script>
</body>
</html>
